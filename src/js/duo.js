/*
 * DUO THEME by https://yeoli-thm.tumblr.com/
 * Copyright (c) 2021 yeoli-thm
 */

!function(t){t.fn.exists=function(){return this.length>0};var e=window.getComputedStyle(document.body),a=e.getPropertyValue("--photosetGutterSize"),o={background:"rgba(0,0,0,0)",color:"rgb("+e.getPropertyValue("--audioPostTextColor")+")"},s=t(window),i=t("body");const n=i.hasClass("index-page"),l=(i.hasClass("permalink-page"),i.hasClass("modeswitch"));var d=i.find("a.mode_toggle_button"),r=i.find("a.updates_toggle_button"),c=i.find("#updates"),p=i.find("a#menu-button"),u=i.find("#m-shadow"),h=i.find("#menu"),f=h.find("a.home"),m=h.find("#navigation a.exp"),g=t("#main"),v=["Month",0],C=0,b=0;const w=i.hasClass("plta"),_=i.hasClass("pltb"),k=i.hasClass("pltc");var y=i.find(".load_more_button");if(_)var x=null,S=400,T=!0;else if(k)x=".load_more_button",S=!1,T=!1;var D=i.find("#to-top"),I={width:14,height:14,"stroke-width":2};function L(){t("[title]").tooltipster({anchor:"top-left",offset:[14,-18],plugins:["follower"],animationDuration:300,delay:100,maxWidth:160,updateAnimation:null,trigger:"custom",triggerOpen:{click:!0,mouseenter:!0,tap:!1,touchstart:!1},triggerClose:{click:!1,mouseleave:!0,originClick:!1,scroll:!0,tap:!0,touchleave:!0}})}function P(){L(),t.tooltipster.group("tooltip"),i.on("mouseover","#sidebar, #updates, .notes",L)}function z(){t(".posts:not(.appended)").each(function(){let e=t(this);if(void 0!==e.attr("id")){e.attr("id");let a=[e.attr("data-month"),e.attr("data-day")];v[0]!==a[0]?(C++,b=1,e.wrap('<div class="month-group-'+C+'"><div class="day-group-'+C+"-"+b+'"></div></div>'),t('<div class="month_label"><span>'+a[0]+"</span></div>").prependTo(g.find(".month-group-"+C)),t('<div class="day_label">'+a[1]+"</div>").prependTo(g.find(".day-group-"+C+"-"+b)),v.splice(0,2,a[0],a[1])):v[1]==a[1]?e.appendTo(g.find(".day-group-"+C+"-"+b)):v[1]!==a[1]&&(b++,e.appendTo(g.find(".month-group-"+C)).wrap('<div class="day-group-'+C+"-"+b+'"></div>'),t('<div class="day_label">'+a[1]+"</div>").prependTo(g.find(".day-group-"+C+"-"+b)),v.splice(1,1,a[1])),e.photoset(),e.video(),e.audio(),function(e){e.find("figure").each(function(){null==t(this).attr("class")&&null!=t(this).attr("data-orig-width")||null!=t(this).attr("data-tumblr-attribution")?t(this).wrap('<div class="npf-wrap-single"/>'):"tmblr-full"!=t(this).attr("class")||t(this).parents(".npf_row").exists()||null!=t(this).attr("data-tumblr-attribution")||t(this).addClass("npf-item")}),e.find(".npf_row").each(function(){t(this).addClass("npf-item");var e=t(this).first(".npf_col").find("a.post_media_photo_anchor").attr("data-big-photo-height"),a=t(this).first(".npf_col").find("a.post_media_photo_anchor").attr("data-big-photo-width"),o=Math.floor(e/a*100);t(this).find(".tmblr-full").css("padding-bottom",o+"%")}),e.find(".npf-item").not(".npf-item + .npf-item").each(function(){t(this).nextUntil(":not(.npf-item)").addBack().wrapAll('<div class="npf-wrap-all"/>')})}(e)}return e.addClass("appended"),this})}if(t.fn.photoset=function(){return this.find(".photo-slideshow:not(.processed)").pxuPhotoset({lightbox:!0,highRes:!0,rounded:!1,exif:!1,captions:!1,gutter:a,photoset:".photo-slideshow",photoWrap:".photo-data",photo:".pxu-photo"})},t.fn.video=function(){return this.find(".tmblr-embed:not(.processed)").each(function(){let e=t(this);if(e.find(".instagram-media").exists())e.addClass("processed");else{let t=e.find("iframe").width(),a=e.find("iframe").height(),o=Math.floor(a/t*100)+"%";e.find("iframe").wrap('<div class="vid-resize"/>'),e.find(".vid-resize").css({"padding-Bottom":o}),e.addClass("processed")}})},t.fn.audio=function(){return this.find("iframe.tumblr_audio_player").load(function(){let e=t(this);e.contents().find(".audio-player").css(o).find(".progress").css({background:"rgba(0,0,0,0)"}),e.css({opacity:"1"})})},P(),feather.replace(I),l){localStorage.getItem("modeStatus")?"Light"==localStorage.getItem("modeStatus")?i.addClass("light"):"Dark"==localStorage.getItem("modeStatus")&&(i.addClass("dark"),d.tooltipster("content","Light mode")):(localStorage.setItem("modeStatus","Light"),i.addClass("light"));var B=localStorage.getItem("modeStatus");d.click(function(t){t.preventDefault(),"Light"==B?(i.toggleClass("light dark"),d.tooltipster("content","Light mode"),B="Dark"):(i.toggleClass("dark light"),d.tooltipster("content","Dark mode"),B="Light"),localStorage.modeStatus=B})}i.fadeTo(1200,1),r.click(function(t){t.preventDefault(),i.hasClass("updates--open")?(r.removeClass("on"),i.removeClass("updates--open").each(function(){setTimeout(function(){c.hide(0)},500)})):(r.addClass("on"),c.show(0,function(){i.addClass("updates--open")}))}),p.add(u).click(function(t){t.preventDefault(),i.hasClass("menu--open")?h.removeClass("on").each(function(){setTimeout(function(){h.hide(0),i.removeClass("menu--open")},500)}):(i.addClass("menu--open"),h.show(0,function(){h.addClass("on")}))}),m.each(function(){let e=t(this),a=t(this).next(".sub-nav"),o=t(this).attr("href").slice(1);0==a.children().length&&e.parent("li").remove(),e.click(function(t){t.preventDefault(),e.hasClass("slct")?(f.removeClass(o+"--active"),e.removeClass("slct"),a.slideUp(250)):(f.addClass(o+"--active"),e.addClass("slct"),a.slideDown(250))})}),z(),t(".npf_row").each(function(){t(this).addClass("clickable")}),n&&!w&&(g.infiniteScroll({path:"a#next",append:"#main .posts",status:".page-load-status",button:x,scrollThreshold:S,prefill:T}),g.on("request.infiniteScroll",function(t,e){y.addClass("hide")}),g.on("append.infiniteScroll",function(e,a,o,s){z(),t(".npf_row:not(.clickable):not(.disabled)").each(function(){t(this).addClass("disabled")});var i=t(s).map(function(){return t(this).attr("id")}).get();Tumblr.LikeButton.get_status_by_post_ids(i),P(),feather.replace(I),y.removeClass("hide")})),s.scroll(function(){var e=t(this).scrollTop();e>300&&!D.hasClass("show")?D.addClass("show"):e<=300&&D.hasClass("show")&&D.removeClass("show")}),D.click(function(e){e.preventDefault(),t("html,body").animate({scrollTop:0},400)}),document.querySelector("#credit .year").textContent=(new Date).getFullYear(),s.load(function(){let e=0,a=setInterval(function(){e<10&&(t(".iframe-controls--desktop").exists()||t(".iframe-controls--phone-mobile").exists())?(clearInterval(a),t(".tmblr-iframe--loaded").clone().appendTo(h.find("#tumblr-controls-box"))):10===e&&clearInterval(a),e++},1e3)})}(jQuery);
