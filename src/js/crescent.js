/*
 * CRESCENT THEME by https://yeoli-thm.tumblr.com/
 * Copyright (c) 2021 yeoli-thm
 */

!function(e){e.fn.exists=function(){return this.length>0};var t=window.getComputedStyle(document.body),i=t.getPropertyValue("--photosetGutterSize"),n={background:"rgba(0,0,0,0)",color:"rgb("+t.getPropertyValue("--accentTextColor")+")"},a=t.getPropertyValue("--maxTruncatedTags"),s=t.getPropertyValue("--maxBlogFollowings"),o=e(window),l=e("body"),r=window.matchMedia("(min-width: 1248px)"),c=l.find("#container"),d=l.find("#left").find(".sidebar__inner"),h=l.find("#right").find(".sidebar__inner"),f=l.hasClass("sxc"),p=l.hasClass("sxa"),u=CSS.supports("position: sticky"),v=l.find("#featured"),g=l.find("#calendar"),m=l.find("#calendarbox"),b=l.find(".calendar_overlay"),y=l.find("#calendarsection"),k=["January","February","March","April","May","June","July","August","September","October","November","December"];const C=new Date,w=C.getFullYear(),D=C.getMonth(),_=C.getDate();var S,T,B,H=w,M=D,E=l.hasClass("sbdark")?"os-theme-thin-dark":"os-theme-thin-light",P=["","k","M","G","T","P","E"];function A(){e("[title]").tooltipster({anchor:"top-left",offset:[14,-18],plugins:["follower"],animationDuration:300,delay:100,updateAnimation:null,trigger:"custom",triggerOpen:{click:!0,mouseenter:!0,tap:!1,touchstart:!1},triggerClose:{click:!1,mouseleave:!0,originClick:!1,scroll:!0,tap:!0,touchleave:!0}})}var I=function(t,i){function n(e,t){var i=o.scrollTop(),n=e;r.matches&&n.containerHeight>n.vpHeight?n.elemHeight>n.vpHeight-80&&n.containerHeight>n.elemHeight?(t.hasClass("sticky--top")&&t.removeClass("sticky--top"),i<=n.elemBottom?t.removeClass("sticky--bottom sticky--end"):i>n.elemBottom&&i<=n.containerBottom?t.hasClass("sticky--bottom")||t.removeClass("sticky--end").addClass("sticky--bottom"):i>n.containerBottom&&(t.hasClass("sticky--end")||t.removeClass("sticky--bottom").addClass("sticky--end"))):t.hasClass("sticky--top")||t.removeClass("sticky--bottom sticky--end").addClass("sticky--top"):r.matches||t.removeClass("sticky--top sticky--bottom sticky--end")}this._varibles={vpHeight:o.height(),containerHeight:c.height(),containerBottom:c.height()+c.offset().top-o.height()+40,elemHeight:i.height(),elemBottom:i.height()+c.offset().top-o.height()},this.recalculate=function(){if(!p||!u)return!1;var a={vpHeight:o.height(),containerHeight:c.height(),containerBottom:c.height()+c.offset().top-o.height()+40,elemHeight:i.height(),elemBottom:i.height()+c.offset().top-o.height()};(function(e,t){var i=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(t);if(i.length!=n.length)return!1;for(var a=0;a<i.length;a++){var s=i[a];if(e[s]!==t[s])return!1}return!0})(this._varibles,a)||(e.extend(this._varibles,a),n(this._varibles,t))},this.stick=function(){if(!p||!u)return!1;n(this._varibles,t)}};function O(){B=k[M],$.text(B),F.text(H),S=new Date(H,M,1).getDay(),T=new Date(H,M+1,0).getDate();for(var t=0;t<S;t++)J.append('<li class="blank"></li>');for(var i=1;i<T+1;i++)i==_&&M==D&&H==w?J.append('<li class="day today tooltip" title="Today">'+i+"</li>"):J.append('<li class="day">'+i+"</li>");e.each(Y,function(e){if(Y[e].eventMonth==M&&Y[e].eventYear==H){let t=J.find("li:nth-of-type("+(Y[e].eventDay+S)+")");if(t.hasClass("has-event"))j.find("#event-"+Y[e].eventDate+" .evt-content").append("<li>"+Y[e].eventDescription+"</li>"),t.find("a").attr("title","View events");else{t.hasClass("today")&&t.removeAttr("title"),t.addClass("has-event").wrapInner('<a href="#event" data-event="'+Y[e].eventDate+'" class="tooltip" title="View event"></a>');const i='<div id="event-'+Y[e].eventDate+'" class="eventbox"><header class="evt-head"><span>'+Y[e].eventDay+", "+B+'</span><a href="#close" class="close-event-button" title="Close"><span class="fx fx-x"></span></a></header><div class="evt-inner"><ul class="evt-content"><li>'+Y[e].eventDescription+"</li></ul></div></div>";j.append(i).find(".evt-inner").overlayScrollbars({className:E})}null!=calendarEvents[e].eventColor&&t.find("a").css("background-color",calendarEvents[e].eventColor)}}),J.find("li.has-event > a").click(function(t){t.preventDefault();const i=e(this).attr("data-event");var n=j.find("#event-"+i),a=n.find("a.close-event-button");return n.show(0,function(){a.click(function(e){e.preventDefault(),n.hide(0)})}),!1}),V.stickySidebar("recalculate")}function N(){r.matches&&!l.hasClass("desktop")?(l.toggleClass("mobile desktop"),v.exists()&&v.prependTo(h),g.exists()&&g.appendTo(y)):r.matches||l.hasClass("mobile")||(l.toggleClass("desktop mobile"),v.exists()&&v.appendTo(d),g.exists()&&g.appendTo(m)),setTimeout(function(){V.stickySidebar("recalculate")},300)}e.fn.stickySidebar=function(t){if(t="string"==typeof t?t:void 0){var i=[];this.each(function(){var t=e(this).data("stickySidebar");i.push(t)});var n=arguments.length>1?Array.prototype.slice.call(arguments,1):void 0,a=[];return this.each(function(e){var s=i[e];if(!s)return console.warn("$.stickySidebar not instantiated yet"),console.info(this),void a.push(void 0);if("function"==typeof s[t]){var o=s[t].apply(s,n);a.push(o)}else console.warn("Method '"+t+"' not defined in $.stickySidebar")}),a.length>1?a:a[0]}return this.each(function(){var t=e(this),i=t.find(".sidebar__inner"),n=new I(t,i);t.data("stickySidebar",n)})},e.fn.photoset=function(){return this.find(".photo-slideshow:not(.processed)").pxuPhotoset({lightbox:!0,highRes:!0,rounded:!1,exif:!1,captions:!1,gutter:i,photoset:".photo-slideshow",photoWrap:".photo-data",photo:".pxu-photo"})},e.fn.video=function(){return this.find(".tmblr-embed:not(.processed)").each(function(){let t=e(this);if(t.find(".instagram-media").exists())t.addClass("processed");else{let e=t.find("iframe").width(),i=t.find("iframe").height(),n=Math.floor(i/e*100)+"%";t.find("iframe").wrap('<div class="vid-resize"/>'),t.find(".vid-resize").css({"padding-Bottom":n}),t.addClass("processed")}})},e.fn.audio=function(){return this.find("iframe.tumblr_audio_player").load(function(){let t=e(this);t.contents().find(".audio-player").css(n).find(".progress").css({background:"rgba(0,0,0,0)"}),t.css({opacity:"1"})})},e.fn.tags=function(){return this.each(function(){if(e(this).hasClass("tagtypea")){let t=e(this).find(".tags");if(t.children().length>a){for(x=1;x<=a;x++)t.find("a.tag:nth-child("+x+")").addClass("visible");t.find("a.tag:nth-child("+a+")").addClass("ellipsis"),t.append('<a href="#expand" class="expand">see all</a>');let i=t.find(".expand");i.click(function(n){n.preventDefault(),t.find(".tag").each(function(){"none"==e(this).css("display")&&e(this).css({display:"inline-block"})}),t.find(".ellipsis").removeClass("ellipsis"),i.hide().remove()})}else t.find("a.tag").addClass("visible");V.stickySidebar("recalculate")}})},e.fn.notecount=function(){return this.find(".notecount").each(function(){let t=function(e){let t=Math.log10(e)/3|0;if(0==t)return e;let i=P[t],n=Math.pow(10,3*t);return+(e/n).toFixed(1)+i}(e(this).text());e(this).text(t)})},!e("#customlinks ul").children().length>0&&e("#customlinks").remove(),e("ul.blogroll-list").exists()&&e("ul.blogroll-list").each(function(){let t=e(this);if(t.children().length>s)for(x=1;x<=s;x++)t.find("li:nth-child("+x+")").addClass("visible");else t.find("li").addClass("visible")}),A(),e.tooltipster.group("tooltip"),l.on("mouseover","#topbar, .sidebar, .notes-wrapper",A),e(".scroll_slider").overlayScrollbars({className:E}),e(".notes-inner").overlayScrollbars({className:E,overflowBehavior:{x:"hidden",y:"scroll"}});var V=e("#left, #right").stickySidebar();if(f?(v.exists()&&v.appendTo(d),g.exists()&&g.appendTo(m)):N(),e(".post:not(.appended)").each(function(){let t=e(this);return t.hasClass("has--caption-visible")&&0==t.find(".caption").children().length&&t.toggleClass("has--caption-visible has--caption-hidden"),t.find(".timeago").timeAgo({time:"letter"}),function(t){t.find("figure").each(function(){null==e(this).attr("class")&&null!=e(this).attr("data-orig-width")||null!=e(this).attr("data-tumblr-attribution")?e(this).wrap('<div class="npf-wrap-single"/>'):"tmblr-full"!=e(this).attr("class")||e(this).parents(".npf_row").exists()||null!=e(this).attr("data-tumblr-attribution")||e(this).addClass("npf-item")}),t.find(".npf_row").each(function(){e(this).addClass("npf-item")}),t.find(".npf-item").not(".npf-item + .npf-item").each(function(){e(this).nextUntil(":not(.npf-item)").addBack().wrapAll('<div class="npf-wrap-all"/>')})}(t),t.photoset(),t.video(),t.audio(),t.tags().notecount(),t.addClass("appended"),V.stickySidebar("recalculate"),this}),c.imagesLoaded().always(function(e){V.stickySidebar("recalculate")}),g.exists()){var z=l.find("a.calendar-button");z.add(b).click(function(e){e.preventDefault(),l.hasClass("calendar--open")?(l.removeClass("calendar--open"),z.tooltipster("content","Calendar"),m.fadeOut(250)):(l.addClass("calendar--open"),z.tooltipster("content","Close"),m.slideDown(300))});for(var F=g.find(".curr_year"),$=g.find(".curr_month"),j=g.find(".calendar-inner"),J=g.find("ul.cld-grid.days"),Y=[],G=0;G<calendarEvents.length;G++){var L=calendarEvents[G].eventDate.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"");let e={eventDate:calendarEvents[G].eventDate.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,""),eventDay:parseInt(L.slice(0,2)),eventMonth:parseInt(L.slice(2,4))-1,eventYear:parseInt(L.slice(4,8)),eventDescription:calendarEvents[G].eventDescription,eventColor:calendarEvents[G].eventColor};Y.push(e)}O(),g.find("a.month-toggle-buttons").each(function(){e(this).click(function(t){return t.preventDefault(),J.empty(),j.find(".eventbox").remove(),"#prev_month"===e(this).attr("href")?0==M?(M=11,H--):M--:11==M?(M=0,H++):M++,O(),!1})})}e("a.totop-button").click(function(t){return t.preventDefault(),e("html, body").animate({scrollTop:0},600),!1}),f||o.resize(function(){N()}),o.scroll(function(){V.stickySidebar("stick");var e=o.scrollTop();e>200&&!l.hasClass("scrolltop--visible")?l.addClass("scrolltop--visible"):e<=200&&l.hasClass("scrolltop--visible")&&l.removeClass("scrolltop--visible")});let Q=0,R=setInterval(function(){Q<20&&e(".iframe-controls--desktop").exists()?(clearInterval(R),e(".tmblr-iframe--loaded.iframe-controls--desktop").clone().appendTo(".controls_wrapper")):10===Q&&clearInterval(R),Q++},1e3)}(jQuery);
