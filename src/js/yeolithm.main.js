/*
 * Copyright (c) 2021 yeoli-thm
 * https://yeolithm.com
 *
 */
 
!function(t){t.fn.exists=function(){return this.length>0};var e=window.getComputedStyle(document.body).getPropertyValue("--photosetGutterSize"),a=t("body"),n=t(window),o=a.find("#to-top"),i=a.find("#landing"),s=a.find("#main"),d=["","k","M","G","T","P","E"];function l(){t("[title]").tooltipster({anchor:"top-left",offset:[14,-18],plugins:["follower"],animationDuration:300,delay:100,maxWidth:200,updateAnimation:null,trigger:"custom",triggerOpen:{click:!0,mouseenter:!0,tap:!1,touchstart:!1},triggerClose:{click:!1,mouseleave:!0,originClick:!1,scroll:!0,tap:!0,touchleave:!0}})}function c(){t(".posts:not(.appended)").each(function(){var e=t(this);return e.find(".timeago_btn .btn_text").timeAgo({time:"letter",spaces:!1}),function(e){e.find("figure").each(function(){null==t(this).attr("class")&&null!=t(this).attr("data-orig-width")||null!=t(this).attr("data-tumblr-attribution")?t(this).wrap('<div class="npf-wrap-single"/>'):"tmblr-full"!=t(this).attr("class")||t(this).parents(".npf_row").exists()||null!=t(this).attr("data-tumblr-attribution")||t(this).addClass("npf-item")}),e.find(".npf_row").each(function(){t(this).addClass("npf-item");var e=t(this).first(".npf_col").find("a.post_media_photo_anchor").attr("data-big-photo-height"),a=t(this).first(".npf_col").find("a.post_media_photo_anchor").attr("data-big-photo-width"),n=Math.floor(e/a*100);t(this).find(".tmblr-full").css("padding-bottom",n+"%")}),e.find(".npf-item").not(".npf-item + .npf-item").each(function(){t(this).nextUntil(":not(.npf-item)").addBack().wrapAll('<div class="npf-wrap-all"/>')})}(e),e.photoset(),e.video(),e.notecount(),e.notesToggle(e),e.addClass("appended"),this})}t.fn.photoset=function(){return this.find(".photo-slideshow:not(.processed)").pxuPhotoset({lightbox:!0,highRes:!0,rounded:!1,exif:!1,captions:!1,gutter:e,photoset:".photo-slideshow",photoWrap:".photo-data",photo:".pxu-photo"})},t.fn.video=function(){return this.find(".tmblr-embed:not(.processed)").each(function(){var e=t(this);if(e.find(".instagram-media").exists())e.addClass("processed");else{var a=e.find("iframe").width(),n=e.find("iframe").height(),o=Math.floor(n/a*100)+"%";e.find("iframe").wrap('<div class="vid-resize"/>'),e.find(".vid-resize").css({"padding-Bottom":o}),e.addClass("processed")}})},t.fn.notecount=function(){return this.find(".notecount_btn .btn_text").each(function(){var e=function(t){var e=Math.log10(t)/3|0;if(0==e)return t;var a=d[e],n=Math.pow(10,3*e);return+(t/n).toFixed(1)+a}(t(this).text());t(this).text(e)})},t.fn.notesToggle=function(e){return this.find(".notes_toggle").click(function(a){a.preventDefault();var n=t(this),o=e.find(".notes-wrapper");n.hasClass("active")?o.slideUp(300,function(){n.removeClass("active")}):(n.addClass("active"),o.slideDown(300,function(){o.find(".notes-holder.unprocessed").exists()&&t.ajax({url:o.attr("data-notes-url"),success:function(t){o.find(".notes-loader").hide(),o.find(".notes-holder").html(t).slideDown().removeClass("unprocessed")}})}))})},0==document.location.pathname.indexOf("/tagged/a%3Aq")?t("a.aq_link").addClass("matched"):0==document.location.pathname.indexOf("/tagged/theme-rec")||0==document.location.pathname.indexOf("/tagged/theme+rec")||0==document.location.pathname.indexOf("/tagged/theme%20rec")?t("a.tr_link").addClass("matched"):0==document.location.pathname.indexOf("/tagged/page-rec")||0==document.location.pathname.indexOf("/tagged/page+rec")||0==document.location.pathname.indexOf("/tagged/page%20rec")?t("a.pr_link").addClass("matched"):0==document.location.pathname.indexOf("/tagged/resources")?t("a.rs_link").addClass("matched"):0==document.location.pathname.indexOf("/tagged/y%3Atut")?t("a.yt_link").addClass("matched"):0==document.location.pathname.indexOf("/terms")?t("a.tm_link").addClass("matched"):0==document.location.pathname.indexOf("/credits")?t("a.cr_link").addClass("matched"):0==document.location.pathname.indexOf("/tagged/blog")?t("a.blog_link").addClass("matched"):0==document.location.pathname.indexOf("/contact")&&t("a.contact_link").addClass("matched"),l(),t.tooltipster.group("tooltip"),a.on("mouseover",".notes",l),a.hasClass("homepage-1")?t(".blog_button").click(function(e){e.preventDefault(),i.fadeOut(300,function(){s.fadeIn(300,function(){c(),t("#site-pagination").show(0),a.removeClass("homepage-1"),i.remove()})})}):(i.exists()&&i.remove(),c()),t("#main pre, .notes-wrapper-inner, .slider").overlayScrollbars({className:"os-theme-thin-dark"}),t(".panel-wrapper").each(function(){var e=t(this);const n=t(this).attr("id");t('a[data-panel-label="'+n+'"]').click(function(t){t.preventDefault(),a.addClass(n+"--active"),e.addClass("show")}),e.on("click",function(o){var i=t(o.target);i.attr("id")!=n&&i.attr("data-panel-close")!=n||(o.preventDefault(),e.toggleClass("show hide"),setTimeout(function(){a.removeClass(n+"--active"),e.removeClass("hide")},300))})}),n.scroll(function(){var e=t(this).scrollTop();e>300&&!o.hasClass("show")?o.addClass("show"):e<=300&&o.hasClass("show")&&o.removeClass("show")}),o.click(function(e){e.preventDefault(),t("html,body").animate({scrollTop:0},400)}),a.keydown(function(t){var e=t.keyCode||t.which;"9"==e||"32"==e?a.addClass("tab-focus"):a.removeClass("tab-focus"),a.click(function(){a.hasClass("tab-focus")&&a.removeClass("tab-focus")})})}(jQuery);
